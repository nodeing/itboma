## 解决 Mac 系统上 npm 全局安装的权限问题

在升级了 Mac OS 12.6 以后，安装出现了权限问题，每次安装全局包的时候都需要加 sudo，这非常的麻烦，以下是解决的步骤

### 第一步，先查看一下 npm 相关配置

```
npm config ls
```

输出结果

```
; "user" config from /Users/key/.npmrc

; node bin location = /usr/local/bin/node
; node version = v16.17.0
; npm local prefix = /Users/key
; npm version = 8.15.0
; cwd = /Users/key
; HOME = /Users/key
; Run `npm config ls -l` to show all defaults.
```

上面结果中，prefix 这个配置项是全局的 npm 包默认安装目录，我们再执行一条命令

```
npm config get prefix
```

输出结果

```
/usr/local
```

默认安装在这个目录就会出现权限问题，这里我们不去改这个目录的默认权限，只需要把 npm 包的默认安装目录配置一下即可

### 第二步，创建全局的 npm 包安装目录

进入到 home 目录下，注意：这里的 home 目录就是当前用户的主目录，系统会为每个用户创建一个 home 目录，例如：我的用户名为 key，默认的 home 目录就是 "/Users/key",在这个目录下创建的目录，当前用户是有权限的，我们通过命令创建一个目录

```
mkdir .npm-global
```

### 第三步，设置 npm 的 prefix 目录

执行命令

```
npm config set "/Users/key/.npm-global"
```

注意哈：上面设置目录的时候，/Users/key/ 这个目录是我的电脑 user 的用户目录，你的电脑具体目录名称和我的不一样，你需要把这个给改掉哈，不然会不生效

### 第四步，设置环境变量

根据终端来操作对应的配置文件，如果只 bash, 你就修改 ~/.bash_profile， 如果是 zsh，就修改 ~/.zshrc, 在配置文件中加入下面的配置

```
export PATH=~/.npm-global/bin:$PATH
```

### 第五步，让配置生效

修改过配置文件，有两种方式生效，第一，关掉终端重启，第二，执行下面的命令

zsh

```
source ~/.zshrc
```

或者，bash

```
source ~/.bash_profile
```

总结：

:::tip
需要知道 npm 配置的相关命令

1. npm config list 可以查看配置

2. npm config ls -l 可以查看所有默认配置项，这里输出的结果就比较多

3. npm config get prefix 可以查看 npm 全局安装包的默认目录位置

4. npm config set prefix 可以设置 npm 全局安装包的默认目录位置

:::
